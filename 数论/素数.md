# 素数相关/线性筛法

判断素数:

```cpp
int sushu(int x)
{
    if(x<=1)return 0;
    for(int i=2; i<=sqrt(x); i++)
        if(x%i==0)
            return 0;
    return 1;
}
```

线性筛法:

```cpp
const int N=1000+7;
ll  prime[N]= {1};
int pcnt=0;
int factor[N]= {1,1};
void Init_Prime()
{
    pcnt=1;
    for(ll i=2; i<N; i++)
    {
        if(!factor[i])
        {
            prime[pcnt++]=i;
            factor[i]=i;
        }
        for(ll j=1; j<pcnt&&i*prime[j]<N; j++)
        {
            factor[i*prime[j]]=prime[j];
            if(!(i%prime[j]))
                break;
        }
    }
    return;
}
 
```

普通筛法:

```cpp
const int N=2000100;
int isprime[N];
void init()
{
    int i,j;
    isprime[1]=1;
    for(i=2; i<=sqrt(N); i++)
    {
        if(!isprime[i])
        {
            for(j=i+i; j<=N; j+=i)
                isprime[j]=1;
        }
    }
}
```

哈理工模板:

```cpp
#include <stdio.h>
#include <string.h>
using namespace std;
const int N = 25600000;
bool a[N];
int p[N];
int n;

void Prime1()
{
    memset(a, 0, n * sizeof a[0]);
    int num = 0, i, j;
    for(i = 2; i < n; ++i) if(!a[i])
        {
            p[num++] = i;
            for(j = i+i; j < n; j +=i)
            {
                a[j] = 1;
            }
        }
}

void Prime2()
{
    memset(a, 0, n*sizeof a[0]);
    int num = 0, i, j;
    for(i = 2; i < n; ++i)
    {
        if(!(a[i])) p[num++] = i;
        for(j = 0; (j<num && i*p[j]<n); ++j)
        {
            a[i*p[j]] = 1;
            if(!(i%p[j])) break;
        }
    }
}
int main()
{
    n = 100;
    Prime2();
}
```

优化空间的线筛

```cpp
for(int i=2; i<N; i++)
{
    if((isprime[i/32]&(1ll<<(i%32)))==0)
    {
        prime[tot++]=i;
    }
    for(int j=0; j<tot&&i*prime[j]<N; j++)
    {
        isprime[i*prime[j]/32]|=1<<(i*prime[j]%32);
        if(i%prime[j]==0)
            break;
    }
}

```

